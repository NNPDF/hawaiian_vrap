name: Regression

on: [push]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Setup Conda 
      uses: conda-incubator/setup-miniconda@v2
      with:
          python-version: 3.9
    - name: Install lhapdf and PDFs
      shell: bash --login {0}
      run: |
        conda install gxx_linux-64 pkg-config sysroot_linux-64=2.17
        conda install -y lhapdf -c conda-forge
        lhapdf install NNPDF31_nnlo_as_0118 
    - name: Compile vrap
      shell: bash --login {0}
      run: |
        cd src && autoreconf -fiv && cd ..
        mkdir -p build && cd build
        ../src/configure --prefix=/usr
        make -j4
        sudo make install
        Vrap ../src/input.dat
    - name: Run some cfactors
      shell: bash --login {0}
      run: |
        cd cfactors_nnpdf40
        make run
